{"version":3,"sources":["Timer.tsx","App.tsx","index.tsx"],"names":["Timer","ms","startTime","stopTime","useState","elapsed","setElapsed","useEffect","intervalId","undefined","getTime","window","setInterval","now","Date","clearInterval","className","Math","round","toFixed","drawTile","width","text","ctx","radius","deg90","PI","deg180","fillStyle","beginPath","arc","fill","font","textBaseline","textAlign","fillText","generateRandomGrid","numbers","i","length","j","floor","random","temp","grid","0","1","2","3","shift","App","canvasRef","useRef","size","innerHeight","gridState","setGridState","setStartTime","setStopTime","moveCount","setMoveCount","findEmptySlot","makeMove","row","col","oldGrid","emptyRow","emptyCol","newGrid","dir","sign","solved","expected","c","canvas","current","clientWidth","height","clientHeight","getContext","handleMouseDown","event","offsetY","offsetX","handleKeyDown","key","addEventListener","document","fillRect","padding","tileWidth","translate","setTransform","drawGrid","removeEventListener","style","onClick","ref","href","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.74218f47.chunk.js","sourcesContent":["import React, { useEffect, useState } from 'react';\n\ninterface TimerProps {\n  startTime?: Date,\n  stopTime?: Date\n}\n\nfunction formatElapsed(ms: number) {\n  return (Math.round(ms / 100) / 10).toFixed(1);\n}\n\nfunction Timer ({ startTime, stopTime }: TimerProps) {\n  const [elapsed, setElapsed] = useState(0);\n\n  useEffect(() => {\n    let intervalId: number | undefined = undefined;\n    if (startTime) {\n      if (!stopTime) {\n        intervalId = window.setInterval(() => {\n          const now = new Date().getTime();\n          setElapsed(now - startTime.getTime());\n        }, 50);\n      } else {\n        setElapsed(stopTime.getTime() - startTime.getTime());\n      }\n    } else {\n      setElapsed(0);\n    }\n\n    return () => clearInterval(intervalId)\n  }, [startTime, stopTime]);\n\n  return (\n    <>\n      <div><strong>Time</strong></div>\n      <div className=\"TimerElapsed\">{formatElapsed(elapsed)}</div>\n    </>\n  );\n}\n\nexport default Timer;\n","import React, { useEffect, useState, useRef } from 'react';\n\nimport './App.css';\n\nimport Timer from './Timer';\n\ninterface Row {\n  0: number | null | undefined,\n  1: number | null | undefined,\n  2: number | null | undefined,\n  3: number | null | undefined\n}\n\ninterface Grid {\n  0: Row,\n  1: Row,\n  2: Row,\n  3: Row\n}\n\nfunction drawTile(width: number, text: string, ctx: CanvasRenderingContext2D) {\n  const radius = 24;\n  const deg90 = Math.PI / 2;\n  const deg180 = Math.PI;\n\n  ctx.fillStyle = '#4438CF';\n\n  ctx.beginPath();\n  // top left corner\n  ctx.arc(radius, radius, radius, deg180, -1 * deg90);\n  // top right corner\n  ctx.arc(width - radius, radius, radius, -1 * deg90, 0);\n  // bottom right corner\n  ctx.arc(width - radius, width - radius, radius, 0, deg90);\n  // bottom left corner\n  ctx.arc(radius, width - radius, radius, deg90, deg180);\n  ctx.fill();\n\n  ctx.font = '64px -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Oxygen';\n  ctx.textBaseline = 'middle';\n  ctx.textAlign = 'center';\n  ctx.fillStyle = 'white';\n  ctx.fillText(text, width / 2, width / 2);\n}\n\nfunction drawGrid(size: number, gridState: any, ctx: CanvasRenderingContext2D) {\n  const padding = 0.03 * size;\n  const drawnArea = size - (5 * padding);\n  const tileWidth = drawnArea / 4;\n\n  for (let row = 0; row < 4; row += 1) {\n    ctx.translate(padding, (row + 1) * padding + row * tileWidth);\n\n    for (let col = 0; col < 4; col += 1) {\n      if (gridState[row][col] !== null) {\n        drawTile(tileWidth, gridState[row][col], ctx);\n      }\n\n      ctx.translate(tileWidth + padding, 0);\n    }\n\n    ctx.setTransform(1, 0, 0, 1, 0, 0);\n  }\n}\n\nfunction generateRandomGrid() : Grid {\n  const numbers = [\n    1, 2, 3, 4,\n    5, 6, 7, 8,\n    9, 10, 11, 12,\n    13, 14, 15, null\n  ];\n\n  // fisher yates shuffle, preserving empty slot\n  for (let i = numbers.length - 2; i > 0; i -= 1) {\n    const j = Math.floor(Math.random() * i);\n    const temp = numbers[i];\n    numbers[i] = numbers[j];\n    numbers[j] = temp;\n  }\n\n  const grid: Grid = {\n    0: {} as Row,\n    1: {} as Row,\n    2: {} as Row,\n    3: {} as Row\n  }\n\n  for (let i = 0; i < 4; i += 1) {\n    for (let j = 0; j < 4; j += 1) {\n      grid[i as keyof Grid][j as keyof Grid] = numbers.shift();\n    }\n  }\n\n  return grid;\n}\n\nfunction App() {\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n  const size = Math.floor(window.innerHeight * 0.5);\n\n  const [gridState, setGridState] = useState(generateRandomGrid());\n  const [startTime, setStartTime] = useState<Date | undefined>();\n  const [stopTime, setStopTime] = useState<Date | undefined>();\n  const [moveCount, setMoveCount] = useState<number>(0);\n\n  const findEmptySlot = (grid: Grid) : number[] => {\n    for (let i = 0; i < 4; i += 1) {\n      for (let j = 0; j < 4; j += 1) {\n        if (grid[i as keyof Grid][j as keyof Grid] === null) {\n          return [i, j];\n        }\n      }\n    }\n\n    return [3, 3];\n  }\n\n  function randomizeGrid() {\n    setStartTime(undefined);\n    setStopTime(undefined);\n    setMoveCount(0);\n    setGridState(generateRandomGrid());\n  }\n\n\n  useEffect(() => {\n    const makeMove = (row: number, col: number) => {\n      if (!startTime) { setStartTime(new Date()) }\n\n      let moveCount = 0;\n      setGridState((oldGrid) => {\n        let [emptyRow, emptyCol] = findEmptySlot(oldGrid);\n\n        const newGrid = {\n          0: { ...oldGrid[0] },\n          1: { ...oldGrid[1] },\n          2: { ...oldGrid[2] },\n          3: { ...oldGrid[3] }\n        };\n\n        if (row !== emptyRow) {\n          let dir = Math.sign(row - emptyRow);\n          while (emptyRow !== row) {\n            newGrid[emptyRow as keyof Grid][emptyCol as keyof Grid] = (\n              newGrid[emptyRow + dir as keyof Grid][emptyCol as keyof Grid]\n            );\n            newGrid[emptyRow + dir as keyof Grid][emptyCol as keyof Grid] = null;\n\n            emptyRow += dir;\n            moveCount += 1;\n          }\n        } else {\n          let dir = Math.sign(col - emptyCol);\n          while (emptyCol !== col) {\n            newGrid[emptyRow as keyof Grid][emptyCol as keyof Grid] = (\n              newGrid[emptyRow as keyof Grid][emptyCol + dir as keyof Grid]\n            );\n            newGrid[emptyRow as keyof Grid][emptyCol + dir as keyof Grid] = null;\n\n            emptyCol += dir;\n            moveCount += 1;\n          }\n        }\n\n        let solved = true;\n        for (let i = 0; i < 4; i += 1) {\n          for (let j = 0; j < 4; j += 1) {\n            let expected: number | null = (4 * i) + (j + 1);\n            if (expected === 16) { expected = null }\n            if (newGrid[i as keyof Grid][j as keyof Grid] !== expected) {\n              solved = false;\n            }\n          }\n        }\n\n        if (solved) { setStopTime(new Date()) }\n\n        return newGrid;\n      });\n\n      setMoveCount((c) => c + moveCount)\n    }\n\n    const canvas = canvasRef.current;\n    if (canvas) {\n      canvas.width = 2 * canvas.clientWidth;\n      canvas.height = 2 * canvas.clientHeight;\n\n      const ctx = canvas.getContext('2d');\n\n      const handleMouseDown = (event: MouseEvent) => {\n        if (stopTime) { return }\n\n        const row = Math.floor((4 * event.offsetY) / canvas.clientHeight);\n        const col = Math.floor((4 * event.offsetX) / canvas.clientWidth);\n\n        const [emptyRow, emptyCol] = findEmptySlot(gridState);\n\n        if ((row === emptyRow) !== (col === emptyCol)) {\n          makeMove(row, col);\n        }\n      };\n\n      const handleKeyDown = (event: KeyboardEvent) => {\n        // do nothing when the timer has stopped\n        if (stopTime) { return }\n\n        const [row, col] = findEmptySlot(gridState);\n\n        switch (event.key) {\n          case 'ArrowUp':\n            if (row !== 3) { makeMove(row + 1, col) }\n          break;\n          case 'ArrowDown':\n            if (row !== 0) { makeMove(row - 1, col) }\n          break;\n          case 'ArrowLeft':\n            if (col !== 3) { makeMove(row, col + 1) }\n          break;\n          case 'ArrowRight':\n            if (col !== 0) { makeMove(row, col - 1) }\n          break;\n        }\n      }\n\n      if (ctx) {\n        canvas.addEventListener('mousedown', handleMouseDown);\n        document.addEventListener('keydown', handleKeyDown);\n\n        ctx.fillStyle = '#D9D9D9';\n        ctx.fillRect(0, 0, canvas.width, canvas.height);\n\n        drawGrid(size * 2, gridState, ctx);\n      }\n\n      return () => {\n        if (canvas) {\n          canvas.removeEventListener('mousedown', handleMouseDown);\n          document.removeEventListener('keydown', handleKeyDown);\n        }\n      };\n    }\n  }, [gridState, startTime, stopTime, size]);\n\n  return (\n    <div className=\"App\">\n      <div className=\"TimerContainer\">\n        <Timer startTime={startTime} stopTime={stopTime} />\n      </div>\n      <div className=\"MovesContainer\">\n        <div><strong>Moves</strong></div>\n        <div className=\"MoveCount\">{moveCount}</div>\n      </div>\n      <div className=\"ButtonRow\" style={{ width: size }}>\n        <button onClick={randomizeGrid}>\n          {stopTime ? 'Play again' : 'Reset'}\n        </button>\n      </div>\n      <div\n        className=\"CanvasContainer\"\n        style={{ height: size, width: size }}\n      >\n        <canvas style={{ height: size, width: size }} ref={canvasRef} />\n      </div>\n      <a href=\"https://twitter.com/ianburgan\" className=\"ContactLink\">\n        Developed by Ian Burgan\n      </a>\n      <div className=\"Instructions\">\n        Click tiles or use arrow keys to move\n      </div>\n    </div>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}